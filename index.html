<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>剑网三大乱斗 - 武侠像素大战略</title>
    <link rel="stylesheet" href="./src/style.css">
</head>
<body>
    <div id="app">
        <!-- UI 层：主菜单、UI面板等 -->
        <div id="ui-layer">
            <div id="menu-background" class="menu-bg"></div>
            <!-- 主菜单 -->
            <div id="main-menu" class="menu-container">
                <div class="menu-decoration-top"></div>
                <h1 class="game-title">剑网三<span>大乱斗</span></h1>
                <div class="menu-options">
                    <button id="start-btn" class="wuxia-btn">闯荡江湖</button>
                    <button id="collection-btn" class="wuxia-btn">侠客名录</button>
                    <button id="options-btn" class="wuxia-btn">江湖设置</button>
                    <button id="exit-btn" class="wuxia-btn">退出游戏</button>
                </div>
                <div class="menu-decoration-bottom"></div>
            </div>

            <!-- 大世界 HUD (简化后的资源显示) -->
            <div id="world-ui" class="hidden">
                <div class="resource-bar" style="top: 15px; left: 10px;">
                    <div class="res-item"><span class="res-emoji">💰</span><span id="world-gold">1000</span></div>
                    <div class="res-item"><span class="res-emoji">🪵</span><span id="world-wood">200</span></div>
                </div>

                <!-- 大世界 HUD：左下角状态区 -->
                <div class="hud-bottom-left" id="world-hud-bottom-left">
                    <!-- 城池卡片：大尺寸 -->
                    <div class="hud-card hud-card-city" id="city-mini-card">
                        <div class="hud-portrait" id="world-city-portrait"></div>
                        <div class="hud-info">
                            <span class="hud-name" id="world-city-display-name">稻香村</span>
                            <span class="hud-sub">当前主城</span>
                        </div>
                    </div>

                    <!-- 英雄卡片：小尺寸，靠右排列 -->
                    <div class="hud-card hud-card-hero" id="hero-mini-card">
                        <div class="hud-portrait" id="world-hero-portrait"></div>
                        <div class="hud-info">
                            <div class="hud-mini-bars">
                                <div class="mini-bar-bg"><div id="hud-hero-hp-bar" class="mini-bar-fill hp"></div></div>
                                <div class="mini-bar-bg"><div id="hud-hero-mp-bar" class="mini-bar-fill mp"></div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 侠客属性面板 -->
                <div id="hero-stats-panel" class="menu-container hidden hero-panel-v3">
                    <div class="menu-decoration-top">侠客名鉴</div>
                    <button id="close-hero-panel" class="close-btn-v3">×</button>
                    
                    <div class="hero-panel-content">
                        <div class="hero-panel-left">
                            <div class="hero-big-portrait" id="hero-panel-portrait"></div>
                            <h2 id="hero-panel-name">祁进</h2>
                            <p id="hero-panel-title" class="char-title">紫虚子</p>
                        </div>
                        
                        <div class="hero-panel-right">
                            <div class="stat-group">
                                <label>经验 (XP)</label>
                                <div class="stat-bar-bg"><div id="hero-xp-bar" class="stat-bar-fill xp"></div></div>
                                <span id="hero-xp-text">0 / 100</span>
                            </div>
                            <div class="stat-group">
                                <label>气血 (HP)</label>
                                <div class="stat-bar-bg"><div id="hero-hp-bar" class="stat-bar-fill hp"></div></div>
                                <span id="hero-hp-text">500 / 500</span>
                            </div>
                            <div class="stat-group">
                                <label>内力 (MP)</label>
                                <div class="stat-bar-bg"><div id="hero-mp-bar" class="stat-bar-fill mp"></div></div>
                                <span id="hero-mp-text">100 / 100</span>
                            </div>
                            
                            <div class="attributes-grid">
                                <div class="attr-item">攻击: <span id="attr-atk">45</span></div>
                                <div class="attr-item">防御: <span id="attr-def">30</span></div>
                                <div class="attr-item">移速: <span id="attr-speed">0.08</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- 下方：技能展示区 -->
                    <div class="hero-skills-section">
                        <h3 class="section-label">习得招式</h3>
                        <div id="hero-panel-skills" class="hero-skills-list">
                            <!-- 动态填充技能图标 -->
                        </div>
                    </div>

                    <div class="menu-decoration-bottom"></div>
                </div>

                <div id="town-management-panel" class="menu-container hidden town-panel-v3">
                    <div class="menu-decoration-top"></div>
                    <button id="close-town-panel" class="close-btn-v3" title="关闭">×</button>
                    <h2 id="town-name" class="town-title-v3">稻香村</h2>
                    
                    <div class="town-main-content">
                        <!-- 左侧：建筑规划 -->
                        <div class="town-construction-section">
                            <div class="construction-container">
                                <div class="construction-category economy">
                                    <div class="cat-label">商业</div>
                                    <div id="build-cat-economy" class="building-grid"></div>
                                </div>
                                <div class="construction-category military">
                                    <div class="cat-label">军事</div>
                                    <div id="build-cat-military" class="building-grid"></div>
                                </div>
                                <div class="construction-category magic">
                                    <div class="cat-label">特殊</div>
                                    <div id="build-cat-magic" class="building-grid"></div>
                                </div>
                            </div>
                        </div>

                        <!-- 右侧：招募面板 -->
                        <div class="town-recruit-section">
                            <div id="town-recruit-list" class="recruit-list-v3"></div>
                        </div>
                    </div>

                    <!-- 底部：调兵遣将区域 -->
                    <div class="town-army-section">
                        <div class="army-container garrison">
                            <div class="army-label">驻守兵力</div>
                            <div id="town-units-list" class="army-slots-v3"></div>
                        </div>
                        <div class="army-transfer-divider">⇅</div>
                        <div class="army-container hero-army">
                            <div class="army-label">我的队伍</div>
                            <div id="hero-army-list" class="army-slots-v3"></div>
                        </div>
                    </div>

                    <div class="menu-decoration-bottom"></div>
                </div>

                <div class="world-date-display-container">
                    <div class="time-progress-outer">
                        <div class="time-progress-circle"></div>
                    </div>
                    <div class="world-date-display">天宝 三年 · 春</div>
                </div>
            </div>

            <!-- 角色选择界面 -->
            <div id="character-select" class="menu-container hidden">
                <div class="menu-decoration-top"></div>
                <h2 class="game-title select-title">选择<span>你的侠客</span></h2>
                <div class="character-cards">
                    <div class="char-card" data-hero="qijin">
                        <div class="char-portrait qijin-portrait"></div>
                        <h3 class="char-name">祁进</h3>
                        <p class="char-title">紫虚子</p>
                        <div class="char-traits">
                            <div class="trait">
                                <span class="trait-tag">门派领袖</span>
                                <span class="trait-desc">纯阳弟子血量和伤害提高 20%</span>
                            </div>
                        </div>
                    </div>
                    <div class="char-card" data-hero="lichengen">
                        <div class="char-portrait lichengen-portrait"></div>
                        <h3 class="char-name">李承恩</h3>
                        <p class="char-title">天策府统领</p>
                        <div class="char-traits">
                            <div class="trait">
                                <span class="trait-tag">骁勇善战</span>
                                <span class="trait-desc">大世界移动速度提高 20%，天策兵种血量提高 10%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="menu-options">
                    <button id="confirm-char-btn" class="wuxia-btn disabled" disabled>开启江湖</button>
                    <button id="back-to-menu-btn" class="wuxia-btn small-btn">返回主页</button>
                </div>
                <div class="menu-decoration-bottom"></div>
            </div>

            <!-- 部署界面 -->
            <div id="deployment-ui" class="deployment-container hidden">
                <div class="deploy-info">请派遣你的侠客 (点击图标后点击地面)</div>
                <div class="unit-slots">
                    <div class="unit-slot" data-type="melee">
                        <div class="slot-icon melee-icon"></div>
                        <span class="slot-count">x10</span>
                    </div>
                    <div class="unit-slot" data-type="ranged">
                        <div class="slot-icon ranged-icon"></div>
                        <span class="slot-count">x4</span>
                    </div>
                    <div class="unit-slot" data-type="archer">
                        <div class="slot-icon archer-icon"></div>
                        <span class="slot-count">x2</span>
                    </div>
                    <div class="unit-slot" data-type="healer">
                        <div class="slot-icon healer-icon"></div>
                        <span class="slot-count">x2</span>
                    </div>
                    <div class="unit-slot" data-type="cangjian">
                        <div class="slot-icon cangjian-icon"></div>
                        <span class="slot-count">x2</span>
                    </div>
                    <div class="unit-slot" data-type="tiance">
                        <div class="slot-icon tiance-icon"></div>
                        <span class="slot-count">x1</span>
                    </div>
                    <div class="unit-slot" data-type="chunyang">
                        <div class="slot-icon chunyang-icon"></div>
                        <span class="slot-count">x2</span>
                    </div>
                    <div class="unit-slot" data-type="cangyun">
                        <div class="slot-icon cangyun-icon"></div>
                        <span class="slot-count">x2</span>
                    </div>
                </div>
                <button id="fight-btn" class="wuxia-btn small-btn">开战！</button>
            </div>

            <!-- 战斗技能栏 (战斗开始后显示) -->
            <div id="battle-skill-bar" class="skill-bar-container hidden">
                <div class="skill-slots" id="skill-slots">
                    <!-- 动态生成技能按钮 -->
                </div>
            </div>

            <!-- 战斗结算界面 -->
            <div id="battle-settlement" class="menu-container hidden">
                <div class="menu-decoration-top">战斗统计</div>
                <h2 id="settlement-title" class="game-title">战斗胜利</h2>
                <div class="settlement-content">
                    <div class="loss-section">
                        <div class="section-label">我方损失兵力</div>
                        <div id="settlement-losses-list" class="loss-list">
                            <!-- 动态填充 -->
                        </div>
                    </div>
                </div>
                <div class="menu-options">
                    <button id="return-to-world-btn" class="wuxia-btn">返回大世界</button>
                </div>
                <div class="menu-decoration-bottom"></div>
            </div>

            <!-- 全局提示框 (Tooltip) -->
            <div id="game-tooltip" class="tooltip-container hidden">
                <div class="tooltip-title"></div>
                <div class="tooltip-level"></div>
                <div class="tooltip-effect"></div>
                <div class="tooltip-desc"></div>
            </div>
        </div>
        
        <!-- Canvas 层：Three.js 渲染 -->
        <canvas id="game-canvas"></canvas>
    </div>
    <script type="module" src="/src/main.js"></script>
</body>
</html>

